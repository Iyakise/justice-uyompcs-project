'use-strict';
function __mpc_uri__(){

    var loc = window.location; 
    var path = "";

    // Check if running on localhost or a live server
    if (loc.hostname === "localhost" || loc.hostname === "127.0.0.1") {
        // For local development (WAMP/XAMPP)
        path = loc.protocol + "//" + loc.hostname + "/justice/";
    } else {
        // For live server â€” automatically use the domain name
        path = loc.protocol + "//" + loc.hostname + "/";
    }

    return path;
}

//function change company name
function __mpc_companyName__(){
    return "JUSTICE (UYO) MPCS";
}

function __mpc_gen_pwd(){

    const pwd = Math.random() . toString(36) . slice(2) + Math.random(). toString(36).toUpperCase().slice(2);

    return pwd;
}

//function to check for loading
function __mpcShowAnimation__(){
    var a, b, c, d, e, f, g, h, i, j, k, l , m , n, o , p, q, r, s, t, u, v, w, x, body;

        a = document.querySelectorAll('.mpc-m'); //selecting only the selectables

        b = document.createElement('DIV'); //animation loading container
        b.className = 'mpc-loading-show';

        c = document.createElement('DIV'); //mpc-loading-sidebar
        c.className = 'mpc-loading-sidebar';
        b.appendChild(c); //child element of b

        d = document.createElement('DIV'); //mpc-loading-right
        d.className = 'mpc-loading-right';

        //creating child element of d variable
        e = document.createElement('DIV'); //load-right-icon
        e.className = 'load-right-icon';
        f = document.createElement('DIV'); //load-right-icon
        f.className = 'load-right-icon';
        g = document.createElement('DIV'); //load-right-icon
        g.className = 'load-right-icon';

        //appending child element of d
        d.appendChild(e) //appending first child of d
        d.appendChild(f) //appending second child of d
        d.appendChild(g) //appending third child of d
        b.appendChild(d); // returning another child of b variable element

        //creating animation main loading mpc-load-display
        h = document.createElement('DIV'); //mpc-load-display
        h.className = 'mpc-load-display';

        //h variable with classname mpc-load-display will have for child element
        i = document.createElement('DIV'); // mpc-load-display CHILD 1
        i.className = 'display-item1-container';
       
        //creating two i child element
        j = document.createElement('DIV'); // FIRST I CHILD ELEMENT
        j.className = 'load-display-items';
        k = document.createElement('DIV'); // second I CHILD ELEMENT
        k.className = 'load-display-items';
        //trying to append child element i variable
        i.appendChild(j); //apppending first child element of i
        i.appendChild(k); //apppending second child element of i

         //appending first child element of h
         h.appendChild(i) //successfully appending first h variable child element which is i variable, 
         //i variabble will have two children which will be grand children of h varable element;

        /// trying to create another child elemnt of h variable element
        l = document.createElement('DIV'); //create element display-item2-container
        l.className = 'display-item2-container'; //this element is a direct decendant of h variable element mpc-load-display

        //variable element will have two children inside of it
        m = document.createElement('DIV'); //FIRST CHILD ELEMNT OF l variable element
        m.className = 'load-display-items1';
        n = document.createElement('DIV'); //SECOND CHILD ELEMNT OF l variable element
        n.className = 'load-display-items2';
        //trying to return child of l variable element to it parent
        l.appendChild(m) // child one return
        l.appendChild(n) // child two return

        h.appendChild(l) //append l element to parent h

        //creating another child elemnt of h variable element
        o = document.createElement('DIV'); //creating parent element of two elemennt which is a child element of h variable
        o.className = 'load-circle'; // this element will have three (3) child element

        p = document.createElement('DIV');
        p.className = 'mpc-load-circle'; //first child of o variable element
        q = document.createElement('DIV');
        q.className = 'mpc-load-circle'; //third child of o variable element
        r = document.createElement('DIV');
        r.className = 'mpc-load-circle'; //third child of o variable element
        
        //trying to return child element to parent element o
        o.appendChild(p) //appending of first child
        o.appendChild(q) //appending of second child
        o.appendChild(r) //appending of third child
        h.appendChild(o); //return o variable element to parent h

        //creating the last element of h 
        s = document.createElement('DIV'); //LAST CHILD OF H VARIABLE ELEMENT
        s.className = 'mpc-load-last'; //this element will have to children

        t = document.createElement('DIV'); //CREATING CHILD ELEMENT S VARIABLE ELEMNT
        t.className = 'last-load-items';
        u = document.createElement('DIV'); //CREATING CHILD ELEMENT S VARIABLE ELEMNT
        u.className = 'last-load-items';

        s.appendChild(t) //child element of s 1
        s.appendChild(u) //child element of s 2

        h.appendChild(s) // THE END :)
        b.appendChild(h) // THE END :) MASTER


    //return all at once
    body = document.querySelector('.mpc-ani-container');
    body.classList.add('mpc-loading');
    body.appendChild(b);
    document.body.classList.add('mpc-loading-frame');

    for (let index = 0; index < a.length; index++) {
        a[index].style.visibility = 'hidden';
    }
}

//function to off animation
function __mpcAnimaitonOff__() {
    var a, b ,c ;

        a = document.querySelector('.mpc-ani-container'); //animation parent element
        b = document.querySelectorAll('.mpc-m');

       // a.remove() // remove animation out

       a.innerHTML = '';
        //let loop through and return back element
        for (let i = 0; i < b.length; i++) {
            b[i].style.visibility = 'visible';
            
        }
        document.body.classList.remove('mpc-loading-frame');
}

//reload this page once click
function __mpcForceReload(){
    var a, b, c;

    a = document.querySelector('.mpc-refresh');
    a.addEventListener('click', () =>{

        window.location.reload();
    })
}

function __showOKaySuccess__(){
    var a, b, c, d, e, cnt;

        cnt = document.createElement('DIV');
        cnt.className = 'succes-check';
        cnt.textContent = 'OKAY';
        a = document.createElement('I');
        a.className = 'fa-check fa fa-3x';

        cnt.appendChild(a);

        return cnt; //return this to caller function

}

function __mpcValidate_transfer() {
    //continue button start here
    var TransferButton, item1, item2, item3, item4, txt, val1, val2, val3, balance;
    const container = document.querySelector('.anytime-pop');

    TransferButton = document.querySelector('.verifyTransferToMpcMEmber');
    balance = document.querySelector('.mpcMainBal'); //balance check

    item2 = document.querySelector('.trans-amount'); //transfer ammount
    txt = document.querySelector('.Usr-rtn'); //ERR MSG
    TransferButton.addEventListener('click', function(){
        item1 = document.querySelector('.rtnAccountName');
        val1 = item1.getAttribute('memid'); //transfer tob member account
        val2 = item1.getAttribute('memPh');
        val3 = item1.getAttribute('memid');
        //FBN-014032313363804601464

        //check if usr type transfer amount
        if(item2.value === '') {
            txt.innerHTML = 'Enter amount...';
            txt.classList.add('toErr')
            item2.style.border = '2px solid red';

            __clearOutMemberNotice__('Usr-rtn', 3000)
        }else {
        
            if(balance.innerText == 0){
                txt.innerHTML = 'Insufficent balance on this account!';     
                txt.classList.add('toErr');

                __clearOutMemberNotice__('Usr-rtn', 3000)
            }else {
                var h = __mpc_popup__();
            
                container.append(h);

            // close_popUp();
            }
        }
    })
}

function __mpc_popup__() {
    

    var a, b, c, d, e, f, g, h, i;

        a = document.createElement('DIV');
        a.classList.add('mpc-popup-inner');
        a.title = 'DOUBLE CLICK HERE TO CLOSE DIALOGUE BOX...';
       // a.setAttribute('ondblclick', 'close_popUp()');


        b = document.createElement('DIV');
        b.className = 'popup-innerWrap outset';
        a.appendChild(b);

        c = document.createElement('h5');
        c.textContent = 'Please confirmed your password!';
        b.appendChild(c);

        d = document.createElement('DIV');
        d.className = 'mpc-memberWrap';
        b.appendChild(d);

        e = document.createElement('INPUT');
        e.className = 'memberPasswordConfirmed cnf';
        e.placeholder = 'Password';
        e.type = 'password';
        d.appendChild(e);

        b.appendChild(d);

        f = document.createElement('BUTTON');
        f.type = 'button';
        f.className = 'cconfirmedProceed';
        f.textContent = 'SEND';
        f.setAttribute('onclick', '__validMemberPassword__()');
        d.appendChild(f);

        g = document.createElement('DIV');
        g.className = 'mpc-memberTransferSuccess';

        b.appendChild(g);

        h = document.createElement('P');
        h.className = 'toErr mpcPopUp-pwd';

        b.appendChild(h);

        

        return a;
}



function __clearOutMemberNotice__(a, b){
    
    setTimeout(function(){
        var clearOut = document.querySelector('.' +a); //clearout what is inside this element
            clearOut.innerHTML = '';
    }, b)
}

//function that confirmed user password
function __validMemberPassword__(){

    var button, a, b, recieverByphone, recieverById, rtnTxt, recieverget, receiverCreditAccountType, transferToAmount, recieverAccountNumber, i, senderId, senderPhone, senderAccountType, senderAccountTypeByname, selectedAccountBalance,  data, pwdPass, xhr, btnSelf;

        button = document.querySelector('.cconfirmedProceed'); //password confirmed
        a = document.querySelector('.memberPasswordConfirmed');
        b = document.querySelector('.mpc-TransferType');
        recieverget = document.querySelector('.rtnAccountName'); //getting reciever here

        selectedAccountBalance = document.querySelector('.mpcMainBal').innerText; // selectedAccountBalance, TOTAL AVAILABLE MONEY IN THIS ACCOUNT;
        senderAccountType = document.querySelector('.mpc-TransferType-account'); //transfered account  with the total amount inside this account
        recieverAccountNumber = document.querySelector('.MemberAccountNumber'); //transfered to account number
        transferToAmount = document.querySelector('.trans-amount'); // amount being transfered
        receiverCreditAccountType = document.querySelector('.creditAccountType'); // receiver credit account type;

        i = senderAccountType.selectedIndex;
        senderAccountTypeByname = senderAccountType.options[i].getAttribute('transferAccountType'); //getting member transfer from account by name here

        senderId = b.getAttribute('mpcmemtransid'); //sender id
        senderPhone = b.getAttribute('mpcmemtransph');// sender phone; 

        //receiver data get
        recieverById = recieverget.getAttribute('memid'); //reciever id
        recieverByphone = recieverget.getAttribute('memph'); //reciever phone;

        rtnTxt = document.querySelector('.mpcPopUp-pwd'); //RETURN ANY ERROR MESSAGE TO MEMBER HERE
        btnSelf = document.querySelector('.cconfirmedProceed'); //GET AND DISABLED BUTTON IMMEDIATELY AFTER CLICK
        
   
      //  cpassword
      pwdPass = a.value;

      data = "PERM=mpcPWdConfirmedTransfer&SenderId="+senderId + '&SenderPhone='+senderPhone + '&ReceiverId=' + 
      recieverById + '&ReceiverPhone=' + recieverByphone + '&SenderActType=' + senderAccountTypeByname + '&SendAmount=' + transferToAmount.value + 
      '&SenderPasswordConfirm=' +pwdPass + '&ReceiverAccountNumber=' + recieverAccountNumber.value + '&SelectedAccountBalance=' + selectedAccountBalance + '&receiverCreditAccountType=' + receiverCreditAccountType.value;

        if(pwdPass === '') {
            rtnTxt.innerHTML = 'Enter confirmed password!';
            __clearOutMemberNotice__('mpcPopUp-pwd', 4000); //clearout error message after a particular time
        }else {
            btnSelf.disabled = true; //button is disabled here
            xhr = new XMLHttpRequest(); //ajax request() start here;
            xhr.open('POST', __mpc_uri__() + 'functions/mpc-mem-ajax.php', true);
            xhr.onreadystatechange = function(){
                if(this.readyState == 4 && this.status == 200){
                    if(this.response == 'Transfer OKAY') {
                        document.querySelector('.mpc-memberTransferSuccess').appendChild(__showOKaySuccess__()); //show success message

                        setTimeout(() => {
                            window.location.reload();
                        }, 3000)
                    }else {
                        btnSelf.disabled = false; //button is enable here
                        rtnTxt.innerHTML = this.response; //return server message here

                        __clearOutMemberNotice__('mpcPopUp-pwd', 3000); //clearout any message be it error or success
                        console.log(this.status + ' transfer to server');
                        console.log(this.response + ' transfer to server');

                    }
                }
            }
            xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhr.send(data);

        }
     //   alert(b.value);
       // alert(recieverByphone);

      //  LoanType adm-select  member-select mpc-MemDisabled
      

        
}

//account not activated function
function __checkMpcStatus__(){
    var notificationData, a, b, c, d, e, f, g, h;

    c = document.createElement('DIV');
    c.classList.add('mpc-popup-inner');
    c.title = 'DOUBLE CLICK HERE TO CLOSE DIALOGUE BOX...';
// a.setAttribute('ondblclick', 'close_popUp()');


    d = document.createElement('DIV');
    d.className = 'popup-innerWrap outset';
    c.appendChild(d);

    e = document.createElement('h5');
    e.textContent = 'Account not activated';
    d.appendChild(e);

    f = document.createElement('h6');
    f.textContent = 'Your Account is not activated, please activate your account by going to your settings, fill in all the required information to get your account activated as soon as possible!.';
    d.appendChild(f);

    g = document.createElement('A');
    g.textContent = 'Take me to settings';;
    g.href = __mpc_uri__() + 'dashboard.php/?action=uidMemberSettings';
    g.title = "TO SETTINGS";
    g.disabled = true;
    d.appendChild(g);

    h = document.createElement('h6');
    h.textContent = 'GOODLIFE UYO MPCS...';
    h.className = 'mpc-moveDown';
    d.appendChild(h);



    return c;
    
}

//close member popup box/dialogue box
function __mpcMemberPOPup__(){
    var a, b, c;
        a = document.querySelector('.mpc-popup-inner'); //parent element/container
        a.addEventListener('dblclick', function(){
            this.remove();
            
           // console.log('MPC MEMBER POP-UP/DIALOGUE BOX CLOSE SUCCESSFUL, DEVELOPER, IYAKISE RAPHAEL ETIM');
        })
}

//clearout text
function __clearoutMpc(a, b){

    setTimeout(function(){
        var clear = document.querySelector('.' + a);
            clear.innerHTML = '';
            clear.classList.remove('to-red-color');

    }, b)
}

//function to close all pop-up inside admin dashboard
function mpc_ReadPopclose() {
    var a, b, c, d;
        a = document.querySelector('.close-mpc-popup');
        b = document.querySelector('.mpc-popup-anytime');

        a.addEventListener('click', function(){
            
            //trying to remove this pop up element
            b.remove();
        })
}


//mpc-inp-dataSelect start
function __mpc_inputDataSelect__(){
    var mainSelect, a, b, c, d,e, f;
        mainSelect = document.querySelector('.mpc-inp-dataSelect');
        mainSelect.addEventListener('change', function(){
            a = document.querySelector('.deposit-item');
            b = document.querySelector('.mpc-group-loan-repayment');
            c = document.querySelector('.mpc-regular-loan-repayment');
            d = document.querySelector('.mpc-debitor');

            //TRYING TO CHECK WHAT ADMIN IS DOING
            if(this.value === 'Deposit'){
                a.style.display = 'block';
                b.style.display = 'none';
                c.style.display = 'none';
                d.style.display = 'none';
                __mpc_Saved_deposit_(); //save deposit start here;
            }else if(this.value === 'Group Loan'){
                a.style.display = 'none';
                c.style.display = 'none';
                b.style.display = 'block';
                d.style.display = 'none';
            }else if(this.value === 'Loan'){
                a.style.display = 'none';
                c.style.display = 'block';
                b.style.display = 'none';
                d.style.display = 'none';

            }else if(this.value === 'Debit'){
                a.style.display = 'none';
                c.style.display = 'none';
                b.style.display = 'none';
                d.style.display = 'block'
            }
        })
}

//mpc members account number search
// function __mpcAdminSearch_memberAcct__(){
//     var mainInput, a, b, c, d, rtn, f, xhr;
//         mainInput = document.querySelector('.mpc-memberAccount');
//         mainInput.addEventListener('input', function(){
//             f = document.querySelector('.mpc-admin-ds-notify');
//             b = document.querySelector('.ownerName'); //return account owner by name here
//             //check to search and confirmed if data contains any unwanted character mpc-admin-ds-notify 
//             if(this.value.search(/[a-z-!@_#$%^&*(+)}{:"'|<>/?]/i) !== -1){
//                 f.innerHTML = "Unwanted character detected, search using Acct. No. " + this.value;
//                 f.classList.add('to-red-color');
//                 __clearoutMpc('mpc-admin-ds-notify', 4000); //clearout
//             }else if(this.value.length < 10){
//                 f.innerHTML = "Please enter correct member account No. to start search " + this.value;
//                 f.classList.add('to-red-color');
//                 __clearoutMpc('mpc-admin-ds-notify', 4000); //clearout
//             }else if(this.value.length > 10){
//                 this.value = '';

//                 f.innerHTML = "Incorrect Account number, to avoid mistake system has cleared out field" + this.value;
//                 f.classList.add('to-red-color');
//                 __clearoutMpc('mpc-admin-ds-notify', 5000); //clearout
//             }else{
//                 this.style.border = 'none'; //remove any red border;
                
//                 __mpcShowAnimation__(); //show loading animation
//                 xhr = new XMLHttpRequest();
//                 xhr.open('GET', __mpc_uri__() + 'functions/mpc-ajax-action.php?xkey=MPCsyAKISE&query='+ this.value, true);
//                 xhr.onreadystatechange = function(){
//                     if(this.readyState == 4  && this.status == 200){
//                         __mpcAnimaitonOff__(); //turn off animatio here

//                         console.log(this.response);
//                         rtn = JSON.parse(this.response);

//                       // alert(rtn.name);

//                         mainInput.setAttribute('mpc-accountOwner', rtn.Name);
//                         mainInput.setAttribute('mpc-acctOwnerPhone', rtn.Phone);
//                         mainInput.setAttribute('mpc-acctOwnerUid', rtn.uid);

//                         b.value = rtn.Name;
//                         b.disabled = true;

//                     }

//                 }
//                 xhr.send();
//             }

//         })
// }

//mpc members account number search
function __mpcAdminSearch_memberAcct__(){
    var mainInput, a, b, c, d, rtn, f, xhr;
        mainInput = document.querySelector('.mpc-memberAccount');
        mainInput.addEventListener('input', function(){
            f = document.querySelector('.mpc-admin-ds-notify');
            b = document.querySelector('.ownerName'); //return account owner by name here
            //check to search and confirmed if data contains any unwanted character mpc-admin-ds-notify 
            if(this.value.search(/[!@_#$%^&*(+)}{:"'|<>/?]/i) !== -1){
                f.innerHTML = "Unwanted character detected, search using STAFF ID No. " + this.value;
                f.classList.add('to-red-color');
                __clearoutMpc('mpc-admin-ds-notify', 5000); //clearout
            }else if(this.value.length < 10){
                f.innerHTML = "Please enter correct member STAFF ID No. to start search " + this.value;
                f.classList.add('to-red-color');
                __clearoutMpc('mpc-admin-ds-notify', 5000); //clearout
            }else if(this.value.length > 10){
                this.value = '';

                f.innerHTML = "Incorrect staff ID number, to avoid mistake system has cleared out field" + this.value;
                f.classList.add('to-red-color');
                __clearoutMpc('mpc-admin-ds-notify', 5000); //clearout
            }else{
                this.style.border = 'none'; //remove any red border;
                
                __mpcShowAnimation__(); //show loading animation
                xhr = new XMLHttpRequest();
                xhr.open('GET', __mpc_uri__() + 'functions/mpc-ajax-action.php?xkey=MPCsyAKISE&query='+ this.value, true);
                xhr.onreadystatechange = function(){
                    if(this.readyState == 4  && this.status == 200){
                        __mpcAnimaitonOff__(); //turn off animatio here

                        console.log(this.response);
                        rtn = JSON.parse(this.response);

                       // alert(rtn.name);

                        mainInput.setAttribute('mpc-accountOwner', rtn.Name);
                        mainInput.setAttribute('mpc-acctOwnerPhone', rtn.Phone);
                        mainInput.setAttribute('mpc-acctOwnerUid', rtn.uid);

                        b.value = rtn.Name;
                        b.disabled = true;

                    }

                }
                xhr.send();
            }

        })
}

//function to save member deposit
function __mpc_Saved_deposit_(){
    var butt, a, b, phone, uid, xhr, rtn, admPrev, Amount, SendData, accountNo, accountOwnerName, creditAccountType, depositorName, depositorPhone;
        butt = document.querySelector('.Deposit');
        butt.addEventListener('click', function(){
            accountNo = document.querySelector('.mpc-memberAccount');
            phone = accountNo.getAttribute('mpc-acctownerphone'); //account onwer phone
            uid = accountNo.getAttribute('mpc-acctowneruid'); //member owner id
            accountOwnerName = accountNo.getAttribute('mpc-accountowner'); //member owner by name
            creditAccountType = document.querySelector('.creditAccountType');//typeof account where money is going into?
            depositorName = document.querySelector('.depositorName'); //depositor name
            depositorPhone = document.querySelector('.depositorPhone'); //depositor phone
            admPrev = document.querySelector('.adm-prev').getAttribute('mpc-admid');
            rtn = document.querySelector('.mpc-admin-ds-notify');
            Amount = document.querySelector('.AmountDeposit');

            if(depositorName.value === ''){
                depositorName.style.border = '1.5px solid red';
                rtn.innerHTML = 'Enter depositor name';
                __clearoutMpc('mpc-admin-ds-notify', 3000); //clearOut message;
            }else if(depositorPhone.value === ''){
                depositorPhone.style.border = '1.5px solid red';
                rtn.innerHTML = 'Enter depositor Phone';
                __clearoutMpc('mpc-admin-ds-notify', 3000); //clearOut message;
            }else if(creditAccountType.value == ''){
                creditAccountType.style.border = '2px solid #ff0000';
                rtn.innerHTML = 'Select Receiver account type';
                __clearoutMpc('mpc-admin-ds-notify', 3000); //clearOut message;
            }else if(Amount.value.search(/[a-z!@#$_%+^&*(){}:"'?|<>,.]/i) !== -1){
                Amount.style.border = '2px solid #ff0000';
                rtn.innerHTML = 'Invalid Amount ' + Amount.value;
                __clearoutMpc('mpc-admin-ds-notify', 3000); //clearOut message
            }else{
                //start ajax request
                __mpcShowAnimation__(); //mpc show animation here
                this.disabled = true; //disabled button to prevent double clicked
                SendData = "PERM=aDDcREditTomember@mpcs&Acctno=" + accountNo.value + '&AcctType='+ creditAccountType.value + '&depositorName=' + depositorName.value + '&depositorPhone=' + depositorPhone.value + '&adminId=' +admPrev+ '&mpcReceiverId=' + uid + '&mpcReceiverPhone=' + phone + '&Amount='+Amount.value;
                xhr = new XMLHttpRequest();
                xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
                xhr.onreadystatechange = function(){
                    if(this.readyState == 4 && this.status == 200){
                        if(this.response == 'Deposit Add'){
                            __mpcAnimaitonOff__(); //turn off animation here
                            rtn.innerHTML = 'Account credited successfully';
                            setTimeout(function(){
                                window.location.reload();
                            }, 2000)
                        }else {
                            __mpcAnimaitonOff__(); //turn off animation here
                            rtn.innerHTML = this.response;
                            this.disabled = false;
                            //console.log(this.response);
                        }
                    }
                }
               // xhr.setRequestHeader('Content-type', 'Application/x-www-form-urlencoded');
                xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                xhr.send(SendData);
            }




        })
}

//create loan for each group member
function __mpcCreatGroupLoan(){
var buttonCreateGroupLoan, xhr, respRtn, toDisalbed;
    buttonCreateGroupLoan = document.querySelectorAll('.mpc-adm-grp-loan-auto');
    respRtn = document.querySelector('.mpc-admin-ds-notify');
    
    for (let i = 0; i < buttonCreateGroupLoan.length; i++) {

        buttonCreateGroupLoan[i].addEventListener('click', function(){
            //getting all input availble
            let inp1, inp2, inp3, loanborrowedAmount, inp5, SendData, memberId, memberPhone, inp6, inp7, TotalRepayment, monthlyRepayment, companyInterestMonthly;
            inp1 = document.querySelector('.avail-groupGet'); //get current selected group
            inp2 = document.querySelector('.gmonth'); //get loan month
            inp3 = document.querySelector('.glrate'); //get loan interest rate
            //inp1 = document.querySelector('.avail-groupGet'); //get current selected group
            //inp1 = document.querySelector('.avail-groupGet'); //get current selected group
            inp6 = document.querySelector('.sec3'); //get monthlyRepayment
            inp7 = document.querySelector('.sec2'); //get company Interest Monthly
            inp5 = document.querySelector('.sec4'); //get Total Repayment


            let incre = i;
            loanborrowedAmount = document.querySelectorAll('.mpc-table-input-fullwidth')[incre];

            companyInterestMonthly = inp7.innerText.replace(/[a-zA-Z!@#$,<>?%^&*(:'")_]/g, '');
            monthlyRepayment = inp6.innerText.replace(/[a-zA-Z!@#$,<>?%^&*(:'")_]/g, '');
            TotalRepayment = inp5.innerText.replace(/[a-zA-Z!@#$,<>?%^&*(:'")_]/g, '');

            //loan running month and interest rate
            memberId = this.getAttribute('mpc-member-id');
            memberPhone = this.getAttribute('mpc-member-phone');

            SendData = 'PERM=KEYGROUPmpcYakise&BorrowerId=' + memberId + '&BorrowerPh='+memberPhone +'&BorrowdAmount='+loanborrowedAmount.value +
            '&BorrowerMonthlyRepay='+monthlyRepayment + '&borrowerTotalReturn='+TotalRepayment + '&companyMonthlyInterest=' + companyInterestMonthly +
             '&BorrowerByGroup=' + inp1.value + '&TotalRunningMonth=' + inp2.value;
            //trying to validate user input
            if(loanborrowedAmount.value === ''){
                respRtn.innerHTML = 'Select group';
                respRtn.classList.add('to-red-color');
                respRtn.classList.add('fa-fade');
            }else {
                xhr = new XMLHttpRequest();
                xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
                xhr.onreadystatechange = function(){
                    if(this.readyState == 4 && this.status == 200){
                        if(this.response == 'Group loan success'){
                            respRtn.innerHTML = "Okay, loan create successful!";
                            buttonCreateGroupLoan[i].disabled = true;
                            loanborrowedAmount.disabled = true;

                        }else{
                            respRtn.innerHTML = this.response;
                            respRtn.classList.add('fa-fade')
                            console.log(this.status)
                        }
                    }
                }
                xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                xhr.send(SendData)
            }

        })
        
    }


}

//calculate group loan intrest value
function __mpc_calCulateInterest__(){
    var input = document.querySelectorAll('.mpc-table-input-fullwidth');

    //loop through all input vbox
    for(let i = 0; i < input.length; i++){
        input[i].oninput = function(){
            this.parentElement.style.border = '2px solid green';

            var amount, interest, months, interest_rate, retn1, retn2, retn3, retn4, rtnTxt, calc;
                amount = this.value;

                retn1 = document.querySelector('.sec1');
                retn2 = document.querySelector('.sec2');
                retn3 = document.querySelector('.sec3');
                retn4 = document.querySelector('.sec4');
                months = document.querySelector('.gmonth');
                interest_rate = document.querySelector('.glrate');
                rtnTxt = document.querySelector('.mpc-admin-ds-notify')
                if(months.value === ''){
                    months.style.border = '1.5px solid #ff0000';
                    rtnTxt.innerHTML = 'Enter Loan running month';
                    rtnTxt.classList.add('to-red-color');

                    this.value = '';
                    __clearOutMemberNotice__('mpc-admin-ds-notify', 3000);
                }else if(interest_rate.value === ''){
                    interest_rate.style.border = '1.5px solid #ff0000';
                    rtnTxt.innerHTML = 'Enter Rate';
                    rtnTxt.classList.add('to-red-color');

                    this.value = '';
                    __clearOutMemberNotice__('mpc-admin-ds-notify', 3000);
                }else {
                    interest_rate = interest_rate.value;
                    months = months.value;
                    interest = (amount * (interest_rate * .01)) / months; //company interest

                   // calc = interest * months + amount;
                  //  alert(calc)
                    var chkInterest, totalAmount;
                    chkInterest = interest;
                    totalAmount = amount;
                    payment = ((amount / months) + interest).toFixed(2); // payment
                    
                    payment = payment.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                    interest = interest.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                    amount = amount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

                    calc = parseFloat(chkInterest) * parseFloat(months) + parseFloat(totalAmount);

                    retn1.innerHTML = amount;
                    retn2.innerHTML = interest;
                    retn3.innerHTML = payment;
                    retn4.innerHTML = calc;
                    //company.innerHTML = chkInterest.toFixed(2);
                   // result.innerHTML = payment;
                   // amountRtn.innerHTML = '&#8358; ' + amount;
                    //k.innerHTML = interest_rate + '%';

                  

                   // m.innerHTML = calc;

                }
        }
    }
}

//THIS FUNCTION WILL FIRE AUTOMATIC WHEN ADMIN START TO TYPE SOMETHING
function __mpcAutoFire__(){
    let a, b, c, d, param, f, g, h, select;
    select = document.querySelector('.memberInfoSearch');
    select.addEventListener('input', function(){
        a = document.querySelector('.queryfort'); //searching parameter
        rtn = document.querySelector('.mpc-admin-ds-notify');
        d = document.querySelector('.queryReturnMpcs'); //return server request to this html using ajax
        b = this.value; //what admin is type;

        if(a.value == '' && b.search(/[0-9!@#$)>%^:;=&*(}'"<?{]/i) != -1){

           rtn.innerHTML = 'Default parameter is Name, Do not add any character, or change parameter';
           rtn.classList.add('to-red-color');
           __clearOutMemberNotice__('mpc-admin-ds-notify', 3000);

           c = 'name'; //search pattern1

        }else if(a.value == 'PHONE' && b.search(/[a-z!@#$)>%^:;=&*(}'"<?{]/i) != -1){

            rtn.innerHTML = 'Use a valid member phone, or change parameter';
            rtn.classList.add('to-red-color');
            __clearOutMemberNotice__('mpc-admin-ds-notify', 3000);
            c = 'phone'; //search pattern2

        }else if(a.value == 'EMAIL' && b.search(/[!#$)>%^:;=&*(}'"<?{]/i) != -1){

            rtn.innerHTML = 'Use a valid member email, or change parameter';
            rtn.classList.add('to-red-color');
            __clearOutMemberNotice__('mpc-admin-ds-notify', 3000);

            c = 'email'; //search pattern3

        }else if(a.value == 'ACCOUNT' && b.search(/[a-z!@#$)>%^:;=&*(}'"<?{]/i) != -1){
            rtn.innerHTML = 'Use a valid member account No., or change parameter';
            rtn.classList.add('to-red-color');
            __clearOutMemberNotice__('mpc-admin-ds-notify', 3000);
            c = 'registration_number'; //search patten 4;
        }else{

            if(a.value == ''){
                param = 'NAME';
            }else if(a.value == 'PHONE'){
                param = 'phone';
            }else if(a.value == 'ACCOUNT'){
                param = 'registration_number';
            }else if(a.value == 'EMAIL'){
                param = 'email';
            }

        d.textContent = 'Please wait... LOADING';
        //variable d reassigned to new something
        var xhr = new XMLHttpRequest();
            xhr.open('GET', __mpc_uri__() + 'functions/mpc-ajax-action.php?xmem=MpcsmeMberInfo&qry=' +param + '&param=' +b, true);
            xhr.onreadystatechange = function(){
                if(this.readyState == 4 && this.status == 200){
                    d.innerHTML = this.response;

                    
                }
            }
            xhr.send();
        }
    })
}

//function to add comma after each 100
function __mpcCountcomma__(){
    var monthlyRepayment = document.querySelectorAll('.R-amount');

        for (let i = 0; i < monthlyRepayment.length; i++) {
            let element, payment, items;
                element = monthlyRepayment[i].innerText;
            
                payment = element.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

                items = document.querySelectorAll('.R-amount')[i].innerHTML = payment

            //element.innerHTML = 'manful';
        }

    var cInterest = document.querySelectorAll('.C-int');
        for (let i = 0; i < cInterest.length; i++) {
            let element, payment, items;
                element = cInterest[i].innerText;
            
                payment = element.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

                items = document.querySelectorAll('.C-int')[i].innerHTML = payment

            //element.innerHTML = 'manful';
        }

        var Trepayment = document.querySelectorAll('.T-repay');
        for (let i = 0; i < Trepayment.length; i++) {
            let element, payment, items;
                element = Trepayment[i].innerText;
            
                payment = element.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

                items = document.querySelectorAll('.T-repay')[i].innerHTML = payment

            //element.innerHTML = 'manful';
        }

        var Mrepayment = document.querySelectorAll('.M-repay');
        for (let i = 0; i < Mrepayment.length; i++) {
            let element, payment, items;
                element = Mrepayment[i].innerText;
            
                payment = element.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

                items = document.querySelectorAll('.M-repay')[i].innerHTML = payment

            //element.innerHTML = 'manful';
        }
}

//GOODLIFE LOAN APPROVAL IS PROCESSED HERE
function __mpc_loan_approvalRequest(){
    var approvedButt = document.querySelectorAll('.mpc-loan-approvedClicked');
    
    //let loop through all the button
    approvedButt.forEach(element => {
        element.addEventListener('click', function(){
            //let collect all the values about a particular member
            let memberId, memberPhone, loanTblId, loanType, loanActivator, xhr, rtn, SendData, groupAndDate;

                loanActivator = document.querySelector('.adm-prev').getAttribute('mpc-admid');
                memberPhone = this.getAttribute('mpc_memph');
                memberId = this.getAttribute('mpc-memid');
                loanTblId = this.getAttribute('mpc-loan-tblid');
                loanType = this.getAttribute('mpc-type');
                groupAndDate = this.getAttribute('mpc-gr-id');
                rtn = document.querySelector('.mpc-admin-ds-notify');

                SendData = "PERMS=KEYActivatOR&LoanType="+loanType + '&LoanTblid='+loanTblId + '&memberId='+memberId + '&memberPhone='+memberPhone + '&loanActivator='+ loanActivator+ '&groupDate=' + groupAndDate;
                 //start processing ajax request
                 xhr = new XMLHttpRequest();
                 xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);

                 xhr.onreadystatechange = function(){
                    if(this.readyState == 4 && this.status == 200){
                        if(this.response == 'Loan Approved'){
                            rtn.innerHTML = 'Loan approved successful';
                        }else{
                            rtn.innerHTML = this.response;
                        }
                    }
                 }
                 xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                 xhr.send(SendData);

        })
    });
}

//function that will save mpc members gurantor
function __mpc_member_guarantor(){
    var guarnatorButton,gInput1, gInput2, gInput3, rtnTxt;
        guarnatorButton = document.querySelectorAll('.Adding-mpc-quarantor');
        rtnTxt = document.querySelector('.mpc-admin-ds-notify');

        for (let i = 0; i < guarnatorButton.length; i++) {
            guarnatorButton[i].addEventListener('click', function(){
                var guarantorInputer, guarantoFor, guarantorPhone, gurantorAddress, gurantortwo, guarantorTwoPhone, guarantorTwoAddress, xhr, param;
                    guarantorInputer = document.querySelector('.adm-prev').getAttribute('mpc-admid');
                    guarantorPhone = this.getAttribute('mpc-qurantor-for');//phone of member this person is guaranteeing for
                    guarantoFor = this.getAttribute('mpc-qurantor-for-id');//id of member this person is guaranteeing for

                    gInput1 = document.querySelectorAll('.quarantorName')[i];
                    gInput2 = document.querySelectorAll('.quarantorPhone')[i];
                    gInput3 = document.querySelectorAll('.quarantorAddr')[i];

                    // gurantor two info
                    // gurantortwo = document.querySelectorAll('.quarantorTwoName')[i];
                    // guarantorTwoPhone = document.querySelectorAll('.quarantorTwoPhone')[i];
                    // guarantorTwoAddress = document.querySelectorAll('.quarantorTwoAddr')[i];

                    //check and validate what admin is type
                if(gInput1.value == ''){
                    rtnTxt.innerHTML = 'Please enter guarantor\'s name.';
                    rtnTxt.classList.add('to-red-color'); //change color to red
                    rtnTxt.classList.add('fa-fade'); //fade in out error message
                    gInput1.style.border = '1.4px solid #ff0000'; ///add red border color

                }else if(gInput2.value == ''){
                    rtnTxt.innerHTML = 'Please enter guarantor\'s phone.';
                    rtnTxt.classList.add('to-red-color'); //change color to red
                    rtnTxt.classList.add('fa-fade'); //fade in out error message
                    gInput2.style.border = '1.4px solid #ff0000'; ///add red border color

                    gInput1.style.border = 'none';
                }
                // else if(gurantortwo.value == ''){
                //     rtnTxt.innerHTML = 'Witness two is required.';
                //     rtnTxt.classList.add('to-red-color'); //change color to red
                //     rtnTxt.classList.add('fa-fade'); //fade in out error message
                //     gurantortwo.style.border = '1.4px solid #ff0000'; ///add red border color

                //     gInput1.style.border = 'none';
                // }else if(guarantorTwoPhone.value == ''){
                //     rtnTxt.innerHTML = 'Witness two Phone is required.';
                //     rtnTxt.classList.add('to-red-color'); //change color to red
                //     rtnTxt.classList.add('fa-fade'); //fade in out error message
                //     gurantortwo.style.border = '1.4px solid #ff0000'; ///add red border color

                //     gInput1.style.border = 'none';
                // }
                else {
                    gInput2.style.border = 'none';
                    gInput1.style.border = 'none';
                    if(gInput3.value == ''){
                        gInput3 = 'UNAVAILABLE';
                    }else{
                        gInput3 = gInput3.value;
                    
                    }

                    // if(guarantorTwoAddress.value == ''){
                    //     guarantorTwoAddress = 'UNAVAILABLE';
                    // }else{
                    //     guarantorTwoAddress = guarantorTwoAddress.value;
                    
                    // }
                    //param = "PERM=MPCADD@guarantor&gname=" + gInput1.value + '&gphone=' + gInput2.value + '&gaddress='+gInput3+ 
                      //      '&inputer=' + guarantorInputer + '&ownerPhone='+ guarantorPhone + '&ownerId=' + guarantoFor;

                    param = JSON.stringify({
                        PERM:  'MPCADD@guarantor',
                        gname:  gInput1.value,
                        gphone: gInput2.value,
                        gaddress: gInput3,
                        // gname2:  gurantortwo.value ,
                        // gname2Phone: guarantorTwoPhone.value,
                        // gname2Addr:  guarantorTwoAddress,
                        inputer: guarantorInputer,
                        ownerPhone: guarantorPhone,
                        ownerId: guarantoFor

                    });

                    xhr = new XMLHttpRequest();
                    xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
                    xhr.onreadystatechange = function(){
                        if(this.readyState == 4 && this.status == 200){
                            if(this.response == 'guarantor assigned'){

                                rtnTxt.innerHTML = 'Guanrantor added successful';
                            }else {
                                rtnTxt.innerHTML = this.response;
                            }
                        }
                    }
                    xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                    xhr.send('witnessMpc=' +param);
                }
            })
            
        }
}

//function to save members loan request
function __loan_repaymentGroup__(){
    var invokerButton, repayerPhone, repayerId, repayerGroup, cashCollector, paymentAmount, paymentType, rtnTxt, xhr, repayTblId; 
        invokerButton = document.querySelectorAll('.mpc-member-repayment-invoker');

        for (let i = 0; i < invokerButton.length; i++) {
            var buttonclick = invokerButton[i].addEventListener('click', function(){
                repayerPhone = this.getAttribute('mpc-repayer-phone'); //payer phone
                repayerGroup = this.getAttribute('mpc-repaymentgroup'); //payer group
                repayerId = this.getAttribute('mpc-member-id'); //payerId
                repayTblId = this.getAttribute('mpc-tbl-id'); //loan table id

                cashCollector = document.querySelector('.adm-prev').getAttribute('mpc-admid'); //cash collector information

                rtnTxt = document.querySelector('.mpc-admin-ds-notify'); //return error/success message here

                //about payment here
                paymentAmount = document.querySelectorAll('.mpc-member-returnAmount')[i]; //amount  paid
                paymentType = document.querySelectorAll('.mpc-repaymenTcheck')[i]; //repayment type is weekly or monthly


                
                if(paymentAmount.value === ''){

                    rtnTxt.innerHTML = 'Please enter repayment amount';
                    rtnTxt.classList.add('to-red-color');
                    rtnTxt.classList.add('fa-fade');

                    paymentAmount.style.border = '1.5px solid red';
                    
                }else if(paymentType.value === ''){
                    rtnTxt.innerHTML = 'Select repayment type';
                    rtnTxt.classList.add('to-red-color');
                    rtnTxt.classList.add('fa-fade');
                    
                    paymentType.style.border = '1.5px solid red';
                    paymentAmount.style.border = 'none';

                }else {
                    paymentType.style.border = 'none';
                    paymentAmount.style.border = 'none';
                    rtnTxt.innerHTML = 'please wait. PROCESSING...';
                    rtnTxt.classList.remove('to-red-color');


                    var sendQ = "PERM=MPCQgroupRepayment&cashCollector="+cashCollector + '&payerId=' + repayerId + '&payerPhone='+ repayerPhone + '&payerGroup='+ repayerGroup + '&payerPayAmount=' + paymentAmount.value + '&payPayType=' + paymentType.value + '&tblId='+ repayTblId;
                    xhr = new XMLHttpRequest();
                    xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php');
                    xhr.onreadystatechange = function(){
                        if(this.readyState == 4 && this.status == 200){
                            if(this.response == 'Payment saved'){
                                rtnTxt.innerHTML = 'Payment received!';

                                //trying to disabled button and input 
                                buttonclick.disabled = true; //button disabled
                                paymentAmount.disabled = true //input disabled

                            }else{
                                rtnTxt.innerHTML = this.response;
                                console.log(this.status)
                            }
                        }
                    }
                    xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                    xhr.send(sendQ);
                }
                
                

            })
            
        }
       // invokerButton.forEach(
          //  button => {
         //       
         //   }
       // )
}


function __mpc_regularLoanRepaymnet__(){
    let allBtn, xhr, rtn;
        allBtn = document.querySelectorAll('.mpc-regular-loan-saved');
        rtn = document.querySelector('.mpc-admin-ds-notify');
        //let create a for loop here
        for (let x = 0; x < allBtn.length; x++) {
            allBtn[x].addEventListener('click', function() {
                    var amountPaid, paymentType, memberid, memberphone, cashCollector, sendRepayment, tblid;

                        cashCollector = document.querySelector('.adm-prev').getAttribute('mpc-admid');
                        amountPaid = document.querySelectorAll('.regular-loanAmountReturn')[x];
                        paymentType = document.querySelectorAll('.repayType')[x];

                        memberid = this.getAttribute('memberid');
                        memberphone = this.getAttribute('memberphone');
                        tblid = this.getAttribute('mpc-tbl-id');
                        

                    
                    if(amountPaid.value === ''){
                        rtn.innerHTML = 'Please enter amount paid by member!';
                        rtn.classList.add('to-red-color');
                        rtn.classList.add('fa-fade');
                        amountPaid.style.border = '1.4px solid red';

                    }else if(paymentType.value === ''){
                        rtn.innerHTML = 'Please select payment type!';
                        rtn.classList.add('to-red-color');
                        rtn.classList.add('fa-fade');
                        amountPaid.style.border = 'none';
                        paymentType.style.color = 'red';
                    }else {
                        amountPaid.style.border = 'none';
                        paymentType.style.color = 'none';
                        rtn.innerHTML = '';

                        allBtn[x].disabled = true;

                        sendRepayment = "PERM=sendRepaymentMPCmeMbers&memberId="+memberid + '&memberPhone='+memberphone + '&amountPaid='+amountPaid.value+'&paymentType='+paymentType.value +'&cashCollector='+cashCollector +'&tblId=' + tblid;
                        xhr = new XMLHttpRequest();
                        xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
                        xhr.onreadystatechange = function() {
                            if(this.readyState == 4 && this.status == 200){
                                if(this.response == 'payment added'){
                                    rtn.innerHTML = 'Payment received';
                                    rtn.style.color = 'green';
                                }else {
                                    rtn.innerHTML = this.response;
                                    allBtn[x].disabled = false;
                                    console.log(this.status)
                                }
                            }
                        }
                        xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                        xhr.send(sendRepayment);
                    }
                })
            
        }
}

//mpc-print function
function __mpcPrinter__(){
    var buttonPrint = document.querySelector('.print-mpc-page');
        buttonPrint.addEventListener('click', function(){

            var open, mpcPrintjs, docx, pgeHead, bootjs, awesome, awesomejs, favicon, printcss, btn;

                pgeHead = "href=" + __mpc_uri__() + 'css/bootstrap.min.css';
                awesome = "href=" + __mpc_uri__() + 'css/all.min.css';
                favicon = "href=" + __mpc_uri__() + 'asset/img/favicon.ico';
                printcss = "href=" + __mpc_uri__() + 'css/mpc-print.min.css';
                bootjs = __mpc_uri__() + 'script/bootstrap.min.js';
                awesomejs = __mpc_uri__() + 'script/all.min.js';
                mpcPrintjs = __mpc_uri__() + 'script/mpc-print.min.js';
                btn = "<button class=\"btn btn-warning mpc-firePrinter\" onclick=\"__printMpcDocx__()\"><i class=\"fas fa-print\"></i></button>";
              //  mpc


                var docx = document.querySelector('.mpc-document-print').innerHTML;

                open = window.open('', '', 345, 345);
                open.document.writeln('<!DOCTYPE html>');
                open.document.writeln('<html>');
                open.document.writeln('<head>');
                open.document.writeln('<title>' +__mpc_companyName__()+ ' ONLINE PRINT</title>');
                open.document.writeln('<meta name="viewport" content="width=device-width, initial-scale=1.0">');
                open.document.writeln('<link rel="stylesheet"' + pgeHead + '>');
                open.document.writeln('<link rel="stylesheet"' + awesome + '>');
                open.document.writeln('<link rel="stylesheet"' + printcss + '>');
                open.document.writeln('<link rel="icon"' + favicon + '>');
                open.document.writeln('<link rel="shortcut icon "' + favicon + '>');
                open.document.writeln("<script src=" + bootjs + "></script");
                open.document.writeln("<script src=" + awesomejs + "></script>");
                open.document.writeln("<script src=" + mpcPrintjs + "></script>");
                open.document.write('</head>');
                open.document.write('<body>');
                open.document.write(docx);
                open.document.write(btn);

              //  var printAblePage = docx; //printable page
              //  open.print(printAblePage);
                

        })
}

//group by each 100,00 e.g 100,000.23
function __amountGroup__(){
    var moneyGroup = document.querySelectorAll('.amountEach');
    
    //loopthrough
    moneyGroup.forEach(
        money => {
           var addGroup =  money.innerText.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

            money.innerHTML = addGroup;
        }
    )
}

//upload application information
function wepAppInfo(){
    let applicationShort = document.querySelector('.mpc-applicationNameShort');
    let applicationLong = document.querySelector('.mpc-applicationNameLong');
    let applicationTitle = document.querySelector('.MPC-PROJECT-title');
    let appInfoBtn = document.querySelector('.App-info');
    let err = document.querySelector('.mpc-admin-ds-notify');



    appInfoBtn.addEventListener('click', function(){
        if(applicationLong.value === '' || applicationShort.value === '' || applicationTitle.value === ''){
            err.innerHTML = 'All input Required';
            err.classList.add('to-red-color');
            err.classList.add('fa-fade');
            return;
        }

        let data = {'appSHORT': applicationShort.value,
                    'appLONG': applicationLong.value,
                    'appTitle': applicationTitle.value
                }
        let url = __mpc_uri__() + 'functions/mpc-ajax-action.php?systemSettings=true';
           xhr = new XMLHttpRequest();
           xhr.open('POST', url, true);
           xhr.onreadystatechange = function(){
            if(this.readyState == 4 && this.status == 200){
                let resp = JSON.parse(this.response);

                if(resp.code == 4400){
                    err.classList.add('to-red-color');
                    error.innerHTML = resp.msg;
                    return;
                }

                err.innerHTML = resp.msg + ', response code =>' + resp.code;

              //  console.log(this.response);
            } 
           }
           xhr.setRequestHeader('Content-type', 'application/json');
           xhr.send(JSON.stringify(data));

    })

}

//disabled 
function __mpc_disabled__(v, p){
    
    let turnOff = document.querySelectorAll('.' + v);
    let errMsg = document.querySelector('.mpc-admin-ds-notify');

    //lloop through all the disable
    turnOff.forEach(
        ele => {
            ele.disabled = true;
            ele.title = "YOU DO NOT HAVE PERMITION TO PERFORM THIS TASK, ONLY (" + p + ") CAN PERFORM THIS TASK!";
        }
    )
            errMsg.innerHTML = "You do not have any permittion to perform this task, only (" + p + ")  can perform this task.!";
            errMsg.classList.add('fa-fade');
            errMsg.classList.add('to-red-color');
}   


//function to upload company logo
function companyLogo(){
    let uploadBtn = document.querySelector('.uploadWebbLogo');
        uploadBtn.addEventListener('change', function(){
            let err, shwPview,b,c,d,e,f, formdata;
                err = document.querySelector('.mpc-admin-ds-notify');
                shwPview = document.querySelector('.new-uploadPreview');
                shwPview.innerHTML = ''; //clearOut ANTHING HERE

                err.innerHTML = 'PROCESSING, Please wait...';
            let uploadFile = this.files[0];
            formdata = new FormData;
            //appending data to form
            formdata.append('logoUpload', uploadFile);

            c = URL.createObjectURL(uploadFile);

            //create new img tag
            d = __mpc_uri__() + 'functions/mpc-ajax-action.php';
            b = document.createElement('IMG');
            b.className = 'mpc-img-Preview';
            b.src = c;
            b.title = 'UPLOADED LOGO';

            shwPview.appendChild(b);

            c = new XMLHttpRequest();
            c.open('POST', d, true);
            c.onreadystatechange = function(){
                if(this.readyState == 4 && this.status == 200){
                    let resp = JSON.parse(this.response);
                    if(resp.code == 'error'){
                        err.innerHTML = resp.msg + ' '+ resp.code;

                        err.style.classList.add('to-red-color');
                        err.style.classList.add('fa-fade');
                        return;
                    }

                    err.innerHTML = resp.msg;

                    console.log(this.response)
                }
            }
            c.send(formdata);



        })
}


//function faviconUpload
function faviconUpload(){
    let uploadBtn = document.querySelector('.FAVICON-MPC');
        uploadBtn.addEventListener('change', function(){
            let err, shwPview,b,c,d,e,f, formdata;
                err = document.querySelector('.mpc-admin-ds-notify');
                shwPview = document.querySelector('.new-iconPreview');
                shwPview.innerHTML = ''; //clearOut ANTHING HERE

                err.innerHTML = 'PROCESSING, Please wait...';
            let uploadFile = this.files[0];
            formdata = new FormData;
            //appending data to form
            formdata.append('SYSTEMFAVICON', uploadFile);

            c = URL.createObjectURL(uploadFile);

            //create new img tag
            d = __mpc_uri__() + 'functions/mpc-ajax-action.php';
            b = document.createElement('IMG');
            b.className = 'mpc-img-Preview';
            b.src = c;
            b.title = 'UPLOADED FAVICON';

            shwPview.appendChild(b);

            c = new XMLHttpRequest();
            c.open('POST', d, true);
            c.onreadystatechange = function(){
                if(this.readyState == 4 && this.status == 200){
                    let resp = JSON.parse(this.response);
                    if(resp.code == 'error'){
                        err.innerHTML = resp.msg + ' '+ resp.code;

                        err.style.classList.add('to-red-color');
                        err.style.classList.add('fa-fade');
                        return;
                    }

                    err.innerHTML = resp.msg;

                    console.log(this.response)
                }
            }
            c.send(formdata);
        })
}

//function count& and group
function cGroup(){
    let grp = document.querySelectorAll('.mpc-countGroup');
    let grpt = document.querySelectorAll('.mpc-countGroup');

    for(let x=0; x < grp.length; x++){
        let grpEach = grp[x].innerHTML;
        let grtn = grpEach.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        
        grpt[x].innerHTML = grtn;
    }

}

//function save company social link url
function saveCompanySocial(){
    let invokerBtn = document.querySelector('.mpcs-urlSaver');
        invokerBtn.onclick = async function(){
            let fb = document.querySelector('.fbookURL');
            let err = document.querySelector('.mpc-admin-ds-notify');
           // let fb = document.querySelector('.');
            let whtspp = document.querySelector('.whtsppURL');
            let insta = document.querySelector('.instaURL');
            let twtr = document.querySelector('.TwterURL');
            let ytb = document.querySelector('.ytbeURL');
            let lkdIn = document.querySelector('.linkedinUrl');

           
        if( whtspp.value == '' /*|| insta.value == '' || twtr.value == '' || ytb.value == '' || lkdIn.value == ''*/){
            err.innerHTML = 'Empty input detected, please try again!';
            err.classList.add('to-red-color');
            err.classList.add('fa-fade');
            return;
        }

        let dataSocialUrl = JSON.stringify({
                        Facebook:  fb.value,
                        Whatsapp:  whtspp.value,
                        Instagram: insta.value,
                        Twitter:   twtr.value,
                        Youtube:   ytb.value,
                        Linkedin:  lkdIn.value
                    });
        __mpcShowAnimation__(); //run mpc animation here
        
        let xhr = new XMLHttpRequest();
            xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php?SPLINK=SOCIALlinks', true);
            xhr.onreadystatechange = function(){
                if(this.readyState == 4 && this.status == 200){
                    let resp = JSON.parse(this.responseText);

                    __mpcAnimaitonOff__(); //turnOff animation HERE
                    if(resp.code == '#MPC301'){
                        err.innerHTML = resp.msg;
                        err.classList.add('to-red-color');
                        err.classList.add('fa-fade');
                        return;
                    }

                    err.innerHTML = resp.msg + ' status=> ' + resp.code;
                    err.classList.remove('fa-fade');
                    err.classList.remove('to-red-color');
                }
            }
            xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhr.send("urlParam=" + dataSocialUrl);

    }
}



//spcial saving start here
function __system_missingData_saving(){
    let missingData = document.querySelectorAll('.splance');
    let userInfo = document.querySelector('.uyo');
        let txt = document.querySelector('.mpc-admin-ds-notify');
        let spcial = document.querySelector('.save-special');

        //$currentBalanceReceiverNewBal = __mpcMemberAccountBal__($conn, $tbl, $ReceiverId, $ReceiverPhone, $tblCol1, $tblCol2)[2] + $DepositAmount; //MEMBERS ACCOUNT BALANCE(CURRENT ACCOUNT BALANCE + NEW DEPOSIT AMOUNT)


        txt.innerHTML = '<mark>Note:</mark> All columns is ontype save'
    for(let x =0; x < missingData.length; x++){

        missingData[x].addEventListener('click', function(){
        this.disabled = true; //disabled the current button
        let index = this.getAttribute('bln');

        let btn = this;

        let dte = document.querySelector('.dte'+ index);
        let debit = document.querySelector('.dbt' + index);
        let credit = document.querySelector('.crdt' + index);
       // let balance = this.value;

        spcial.innerHTML = `<i class="fas fa-spinner fa-spin"></i>`;
        spcial.title = 'Please wait... PROCESSING';

        let data = JSON.stringify({
            date: dte.value,
            debit: debit.value,
            credit: credit.value,
          //  balance: balance,
            phone: userInfo.getAttribute('ph'),
            uid: userInfo.getAttribute('uid')
        })

    if(debit.value == ''){
        debit.style.border = '1px solid red';
        this.disabled = false;
    }else if(credit.value == ''){
        credit.style.border = '1px solid red';
        this.disabled = false;
    }else if(dte.value == ''){
        dte.style.border = '1px solid red';
        this.disabled = false;
    }else{

debit.style.border = 'none'
credit.style.border = 'none'
dte.style.border = 'none';
        let xhr = new XMLHttpRequest();
            xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
            xhr.onreadystatechange = function(){
                if(this.readyState === 4 && this.status === 200){
                    let resp = JSON.parse(this.response);

                    if (resp.code == 200) {
                        txt.innerHTML = resp.msg;
                        spcial.innerHTML = '&#8358;'+ resp.bal;
                        btn.innerHTML = '<i class="fas fa-check"></i>saved';
                        btn.title = 'Saved';

                        dte.disabled = true;
                        debit.disabled = true;
                        credit.disabled = true;
                    }else{
                        txt.innerHTML = resp.response.msg;
                    }

                   // alert(this.response)//
                }
            }
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.send('XsmsSpecial=' + data);
    }
        })
    }
}

function __system_missingDataShares_saving(){
    let missingData = document.querySelectorAll('.share-Saving');
    let userInfo = document.querySelector('.uyo');
        let txt = document.querySelector('.mpc-admin-ds-notify');
        let spcial = document.querySelector('.save-share');

        //$currentBalanceReceiverNewBal = __mpcMemberAccountBal__($conn, $tbl, $ReceiverId, $ReceiverPhone, $tblCol1, $tblCol2)[2] + $DepositAmount; //MEMBERS ACCOUNT BALANCE(CURRENT ACCOUNT BALANCE + NEW DEPOSIT AMOUNT)


        txt.innerHTML = '<mark>Note:</mark> All columns is ontype save'
    for(let x =0; x < missingData.length; x++){

        missingData[x].addEventListener('click', function(){
        this.disabled = true; //disabled the current button
        let index = this.getAttribute('bln');

        let btn = this;

        let dte = document.querySelector('.share_dte'+ index);
        let debit = document.querySelector('.share_dbt' + index);
        let credit = document.querySelector('.share_crdt' + index);
       // let balance = this.value;

        spcial.innerHTML = `<i class="fas fa-spinner fa-spin"></i>`;
        spcial.title = 'Please wait... PROCESSING';

        let data = JSON.stringify({
            date: dte.value,
            debit: debit.value,
            credit: credit.value,
          //  balance: balance,
            phone: userInfo.getAttribute('ph'),
            uid: userInfo.getAttribute('uid')
        })

    if(debit.value == ''){
        debit.style.border = '1px solid red';
        this.disabled = false;
    }else if(credit.value == ''){
        credit.style.border = '1px solid red';
        this.disabled = false;
    }else if(dte.value == ''){
        dte.style.border = '1px solid red';
        this.disabled = false;
    }else{

debit.style.border = 'none'
credit.style.border = 'none'
dte.style.border = 'none';



        let xhr = new XMLHttpRequest();
            xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
            xhr.onreadystatechange = function(){
                if(this.readyState === 4 && this.status === 200){
                    let resp = JSON.parse(this.response);

                    if (resp.code == 200) {
                        txt.innerHTML = resp.msg;
                        spcial.innerHTML = '&#8358;'+ resp.bal;
                        btn.innerHTML = '<i class="fas fa-check"></i>saved';
                        btn.title = 'Saved';

                        dte.disabled = true;
                        debit.disabled = true;
                        credit.disabled = true;
                    }else{
                        txt.innerHTML = resp.response.msg;
                    }

                   // alert(this.response)//
                }
            }
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.send('XsmsSharesSaving=' + data);
   }
        })
    }
}

//THRIFT SAVVING START HERE
function __system_missingDataThrift_saving(){
    let missingData = document.querySelectorAll('.thrift-Saving');
    let userInfo = document.querySelector('.uyo');
        let txt = document.querySelector('.mpc-admin-ds-notify');
        let spcial = document.querySelector('.save-thrift');

        //$currentBalanceReceiverNewBal = __mpcMemberAccountBal__($conn, $tbl, $ReceiverId, $ReceiverPhone, $tblCol1, $tblCol2)[2] + $DepositAmount; //MEMBERS ACCOUNT BALANCE(CURRENT ACCOUNT BALANCE + NEW DEPOSIT AMOUNT)


        txt.innerHTML = '<mark>Note:</mark> All columns is ontype save'
    for(let x =0; x < missingData.length; x++){

        missingData[x].addEventListener('click', function(){
        this.disabled = true; //disabled the current button
        let index = this.getAttribute('bln');

        let btn = this;

        let dte = document.querySelector('.thrift-dte'+ index);
        let debit = document.querySelector('.thrift-dbt' + index);
        let credit = document.querySelector('.thrift-crdt' + index);
       // let balance = this.value;

        spcial.innerHTML = `<i class="fas fa-spinner fa-spin"></i>`;
        spcial.title = 'Please wait... PROCESSING';
        // alert(dte.value);

        let data = JSON.stringify({
            date: dte.value,
            debit: debit.value,
            credit: credit.value,
          //  balance: balance,
            phone: userInfo.getAttribute('ph'),
            uid: userInfo.getAttribute('uid')
        })

    if(debit.value == ''){
        debit.style.border = '1px solid red';
        this.disabled = false;
    }else if(credit.value == ''){
        credit.style.border = '1px solid red';
        this.disabled = false;
    }else if(dte.value == ''){
        dte.style.border = '1px solid red';
        this.disabled = false;
    }else{

debit.style.border = 'none'
credit.style.border = 'none'
dte.style.border = 'none';



        let xhr = new XMLHttpRequest();
            xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
            xhr.onreadystatechange = function(){
                if(this.readyState === 4 && this.status === 200){
                    let resp = JSON.parse(this.response);

                    if (resp.code == 200) {
                        txt.innerHTML = resp.msg;
                        spcial.innerHTML = '&#8358;'+ resp.bal;
                        btn.innerHTML = '<i class="fas fa-check"></i>saved';
                        btn.title = 'Saved';

                        dte.disabled = true;
                        debit.disabled = true;
                        credit.disabled = true;
                    }else{
                        txt.innerHTML = resp.response.msg;
                    }

                   // alert(this.response)//
                }
            }
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.send('XsmsThriftSaving=' + data);
   }
        })
    }
}

//paste ster here 
//search member
//add member for debit
function __addFordebit(){
    let btn = document.querySelectorAll('.add-memberTodebit');
    let accountRtn = document.querySelector('.debitAccount');
    let accountName = document.querySelector('.DebitAccountName');
    let controllerBtn = document.querySelector('.controller-btn');
    let bln = document.querySelector('.accountBalance');
    let accountSelector = document.querySelector('.mpc-loadBalance');

    for(let x =0; x < btn.length; x++){
        btn[x].addEventListener('click', function(){
            let name = this.getAttribute('name');
            let acct = this.getAttribute('acc');
            let phone = this.getAttribute('ph');
            let uid = this.getAttribute('uid');

            accountRtn.value = acct;
            accountName.value = name;

            accountName.disabled = true;
            accountRtn.disabled = true;

            accountName.title = 'Hey Stop that! Disabled';
            accountRtn.title = 'Hey Stop that! Disabled';

            controllerBtn.setAttribute('memberId', uid);
            controllerBtn.setAttribute('memberPhone', phone);

            controllerBtn.removeAttribute('ibadakuk-siba');
            bln.innerHTML = 0;
            accountSelector.value = '';

        })
    }

}

//load balance
function __getAccountBalance__(){
    let accountTtype = document.querySelector('.mpc-loadBalance');
    let btn = document.querySelector('.controller-btn');
    // let accountTtype = document.querySelector('.');
    let err = document.querySelector('.mpc-admin-ds-notify');
    let accountRtn = document.querySelector('.debitAccount');
    let accountName = document.querySelector('.DebitAccountName');
    let mainBalance = document.querySelector('.accountBalance');

    accountTtype.addEventListener('change', function() {
        let uid = btn.getAttribute('memberId');
        let phone = btn.getAttribute('memberPhone');

        let account = this.value;

      if(this.value == ''){
        this.style.border = '1.6px solid #ff0000';
        btn.style.disabled = true;
        return;
      }
        // alert(account)
        if(uid == null || uid == 'null' && phone == null || phone == 'null'){
            accountName.style.border = '1.5px solid red';
            accountRtn.style.border = '1.5px solid red';
            err.innerHTML = 'Please add co-operative member first.';
            err.classList.add('to-red-color');
            err.classList.add('fa-fade');
        
            window.scrollTo(0, 0); //scroll back to top

            return;
        }

        this.style.border = 'none';

        accountName.style.border = 'none';
        accountRtn.style.border = 'none';

        accountRtn.style.border = 'none';
        accountName.style.border = 'none';

        //add loading spin icon
        mainBalance.innerHTML = `<i class="fas fa-spinner fa-spin"></i>`;
        btn.disabled = true; //disabled button here

        let data = JSON.stringify({
                        Account: account, 
                        uid: uid, 
                        phone: phone,

                    });

        let xhr = new XMLHttpRequest();
            xhr.open('GET', __mpc_uri__() + 'functions/mpc-ajax-action.php?DXLS=' + data, true);
            xhr.onreadystatechange = function(){
                if(this.readyState == 4 && this.status == 200){
                    //mainBalance.innerHTML = JSON.parse(this.response).balance;
                    let resp = JSON.parse(this.response);

                    if(resp.status !== 200){
                        err.innerHTML = 'Unknown Error occur, please contact system developer ASAP.';
                        mainBalance.innerHTML = 'ERROR';
                        return;
                    }

                    //update member balance here
       // let grtn = grpEach.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

                    mainBalance.innerHTML = resp.balance.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                    err.innerHTML = '';
                    btn.setAttribute('ibadAkuk-Siba', resp.balance);
                    btn.disabled = false;
                }
            }
            xhr.send();
    })
}

//debit member account
function __processMpc_debit(){
    let btn = document.querySelector('.controller-btn');
        btn.addEventListener('click', function(){
            //get neccessary data about member
            let uid = this.getAttribute('memberid');
            let phone = this.getAttribute('memberphone');
            let err = document.querySelector('.mpc-admin-ds-notify');
            let AccountType = document.querySelector('.mpc-loadBalance');
            let accountDigit = document.querySelector('.debitAccount');
            let dbtorId = document.querySelector('.mpc-debitor').getAttribute('ddd');
            let balance = this.getAttribute('ibadakuk-siba');
            let mainBalance = document.querySelector('.accountBalance'); //MAIN BALANCE HERE

            //let uid = this.getAttribute('uid');

            let dbAmount = document.querySelector('.AMountDebit');
            let reasonForDebit = document.querySelector('.ReasonFor');

            //rtn and check amount trying to debit
            if(balance <= 0){
                err.innerHTML = 'Insufficent Ballance on this account, please try another account.';
                err.classList.add('to-red-color');
                err.classList.add('fa-fade');
            return;
            }/*else if(dbAmount.value >= balance){
                err.innerHTML = 'Debit amount is greater than what is in this Account!';
                err.classList.add('to-red-color');
                err.classList.add('fa-fade');
            return;
            }*/else if(dbAmount.value == ''){
                err.innerHTML = 'Input debit amount';
                dbAmount.style.border = '1.7px solid #ff0000';
                err.classList.add('to-red-color');
                err.classList.add('fa-fade');
                return;
            }else if(reasonForDebit.value == ''){
                err.innerHTML = 'Explain why you debit this member.'
                reasonForDebit.style.border = '1.5px solid red';
                err.classList.add('to-red-color');
                err.classList.add('fa-fade');
                return;
            }

            dbAmount.style.border = 'none';
            reasonForDebit.style.border = 'none';

            let data = JSON.stringify({
                    uid: uid,
                    phone: phone,
                    balance: balance,
                    debitorId: dbtorId,
                    debit: dbAmount.value,
                    reasonForDebit: reasonForDebit.value,
                    accountType: AccountType.value,
                    accountDigit:accountDigit.value
                });
            mainBalance.innerHTML = `<i class="fas fa-spinner fa-spin"></i>`; //MAIN BALANCE LOAD ICON
            mainBalance.title = 'COMPUTING... Please wait.';
            
            let xhr = new XMLHttpRequest();
                xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
                xhr.onreadystatechange = function(){
                    if(this.readyState == 4 && this.status == 200){
                        let resp = JSON.parse(this.response);

                        if(resp.code != 200){
                        //    err.innerHTML = 
                            mainBalance.innerHTML = 'Can\'t retrieved balance, Reload';
                            mainBalance.classList.add('to-red-color');
                            mainBalance.classList.add('fa-fade');
                            return;
                        }

                        err.innerHTML = '&#8358; ' +dbAmount.value + ' ' + resp.msg;
                        mainBalance.innerHTML = resp.balance; //return new balance here
                        mainBalance.title = 'New balance: ('+ resp.balance + ')';

                        //alert(this.response);
                    }
                }
                xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                xhr.send('debitThatFuckenMember=' + data);

        })
}

//take action on loan approval request
function __takeACtionToLoan(){
    let allActionBtn = document.querySelectorAll('.mpxc-online-loan-approve-RQ')

    for(let i =0; i<allActionBtn.length; i++){
        allActionBtn[i].addEventListener('click', function(){
            let itmCont = document.createElement('DIV');
                itmCont.className = 'mpc-popup-anytime mpc-blur';

        let attr1 = this.getAttribute('name');
        let attr2 = this.getAttribute('amountrq');
        let attr3 = this.getAttribute('mpc-memid');
        let attr4 = this.getAttribute('mpc_memph');
        // let attr1 = this.getAttribute('name');
        // let attr1 = this.getAttribute('name');

            let imtcontChild = document.createElement('DIV');
                imtcontChild.className = 'mpc-popup-bg';
                itmCont.appendChild(imtcontChild);

            let popclose = document.createElement('DIV');
                popclose.className = 'close-mpc-popup';
                popclose.title = 'Click here to close this pop-up Box';
                    let itag = document.createElement('I');
                        itag.className = 'fas fa-xmark fa-2x';
                popclose.appendChild(itag);
                imtcontChild.appendChild(popclose);

            let spn = document.createElement('SPAN');
                spn.className = 'Upload-status';
                spn.innerHTML = 'Approve loan here...'
                imtcontChild.appendChild(spn);

            let popInner = document.createElement('DIV');
                popInner.className = 'mpc-popup-inner';
                imtcontChild.appendChild(popInner);

                let popInnerTbl = document.createElement('DIV');
                    popInnerTbl.className = 'table-responsive';
                    popInner.appendChild(popInnerTbl);
                        let tbl = document.createElement('TABLE');
                            tbl.className = 'table table-bordered table-striped table-hovered';
                            popInnerTbl.appendChild(tbl);

                                let tblTr = document.createElement('TR');
                                    tbl.appendChild(tblTr);

                                let td1 = document.createElement('TD');
                                    td1.innerText = '#';
                                    tblTr.appendChild(td1);

                                let td2 = document.createElement('TD');
                                    td2.innerText = 'Name';
                                let td3 = document.createElement('TD');
                                    td3.innerText = 'Amount';
                                let td4 = document.createElement('TD');
                                    td4.innerText = 'Comment';
                                let td5 = document.createElement('TD');
                                    td5.innerText = 'Action  1';
                                let td6 = document.createElement('TD');
                                    td6.innerText = 'Action 2';
                                    tblTr.appendChild(td2);
                                    tblTr.appendChild(td3);
                                    tblTr.appendChild(td4);
                                    tblTr.appendChild(td5);
                                    tblTr.appendChild(td6);

//-----------------------------------------------------------------------------------------------------------------
                        let tr2 = document.createElement('TR');
                            tbl.appendChild(tr2);

                                let ntd1 = document.createElement('TD');
                                    ntd1.innerText = attr3;
                                let ntd2 = document.createElement('TD');
                                    ntd2.innerText = attr1;
                                let ntd3 = document.createElement('TD');
                                    ntd3.innerText = attr2;
                                let ntd4 = document.createElement('TD');
                                    let inp = document.createElement('INPUT');
                                        inp.className = 'setStyle LoanType Cmmt';
                                        inp.placeholder = 'Comment here';
                                    ntd4.appendChild(inp);

                                let ntd5 = document.createElement('TD');
                                        let actionBtn1 = document.createElement('BUTTON');
                                            actionBtn1.className = 'btn btn-success approvedLoan text-dark';
                                            actionBtn1.innerText = 'Approve';
                                            actionBtn1.setAttribute('data-uid', attr3);
                                            actionBtn1.setAttribute('data-phone', attr4);
                                        ntd5.appendChild(actionBtn1);

                                let ntd6 = document.createElement('TD');
                                        let actionBtn2 = document.createElement('BUTTON');
                                            actionBtn2.className = 'btn btn-danger DeclineLoan text-dark';
                                            actionBtn2.innerText = 'Deline';
                                            actionBtn1.setAttribute('data-uid', attr3);
                                            actionBtn1.setAttribute('data-phone', attr4);
                                        ntd6.appendChild(actionBtn2);
                            tr2.appendChild(ntd1);
                            tr2.appendChild(ntd2);
                            tr2.appendChild(ntd3);
                            tr2.appendChild(ntd4);
                            tr2.appendChild(ntd5);
                            tr2.appendChild(ntd6);

                            // let ntd1 = document.createElement('DIV');


            document.body.appendChild(itmCont);
mpc_ReadPopclose(); //close pop box
__mpc_ApproveLoan(); //approve loan request
__mpc_DelineLoan(); //decline loan here
        })
    }

    // alert('computer')  +=
}

//approve loan  
function __mpc_ApproveLoan(){
    let btn = document.querySelector('.approvedLoan');
        btn.onclick = function(){
            let cmmt = document.querySelector('.Cmmt');
            let decline = document.querySelector('.DeclineLoan');
            let memberId = this.getAttribute('data-uid');
            let memberPhone = this.getAttribute('data-phone');
            let successMsg = document.querySelector('.Upload-status');
            let adminId = document.querySelector('.mpc-loan-activator').getAttribute('adm-uid');
        this.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
        decline.disabled = true; //disable decline button if user clicked on approved button

            let data = JSON.stringify({uid:memberId, phone:memberPhone, cmmt:cmmt.value, admId: adminId});
            if(cmmt.value === ''){
                err = document.querySelector('.Upload-status');
                successMsg.classList.add('fa-fade');
                successMsg.classList.add('text-danger');

                // alert(successMsg)
                successMsg.innerHTML = 'Comment on this loan, let this member knows where to get his/her money!';
                this.innerHTML = 'Approve';
                return;
            }
            let xhr = new XMLHttpRequest();
                xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
                xhr.onreadystatechange = function(){
                    if(this.readyState == 4 && this.status == 200){
                        let resp = JSON.parse(this.response);
                        if(resp.status == '#200'){
                            btn.innerHTML = '<i class="fas fa-check"></i>';
                            btn.innerHTML += 'Approved';
                            btn.classList.add('text-center');
                            btn.disabled = true;

                            successMsg.innerHTML = resp.msg; //return successmessage
                            return;
                        }

                        successMsg.innerHTML = resp.msg;
                        successMsg.classList.add('fa-fade');
                        successMsg.classList.add('text-success');
                        btn.innerHTML = 'Approve';
                        btn.disabled = false;
                        decline.disabled = false;

                    }
                }
                xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                xhr.send('ApprovedLoan='+data);


        }
}

//DECLINE LOAN loan  
function __mpc_DelineLoan(){
    let btn = document.querySelector('.DeclineLoan');
    let approvedBtn = document.querySelector('.approvedLoan');

        btn.onclick = function(){
            let cmmt = document.querySelector('.Cmmt');
            let memberId = this.getAttribute('data-uid');
            let memberPhone = this.getAttribute('data-phone');
            let successMsg = document.querySelector('.Upload-status');
            let adminId = document.querySelector('.mpc-loan-activator').getAttribute('adm-uid');
        this.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
        approvedBtn.disabled = true;

            let data = JSON.stringify({uid:memberId, phone:memberPhone, cmmt:cmmt.value, admId: adminId});
            if(cmmt.value === ''){
                successMsg.classList.add('fa-fade');
                successMsg.classList.add('text-danger');
                successMsg.innerHTML = 'Leave a comment, let this member understand why this loan request was declined';
                this.innerHTML = 'Decline';
                return;
            }

            let xhr = new XMLHttpRequest();
                xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
                xhr.onreadystatechange = function(){
                    if(this.status == 200 && this.readyState == 200){
                        let resp = JSON.parse(this.response);
                        if(resp.status == '#200'){
                            btn.innerHTML = '<i class="fas fa-check"></i>';
                            btn.innerHTML += 'Approved';
                            btn.classList.add('text-center');

                            successMsg.innerHTML = resp.msg; //return successmessage
                            return;
                        }

                        successMsg.innerHTML = resp.msg;
                        successMsg.classList.add('fa-fade');
                        successMsg.classList.add('text-success');
                        btn.innerHTML = 'Decline';
                        approvedBtn.disabled = false;
                    }
                    
                }
                xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                xhr.send('DeclineLoan='+data);


        }
}

//let trackcing of loan start here
function trackLoanStart(){
    let trackerInput = document.querySelector('.trackingId');
        trackerInput.addEventListener('input', function(){
            let val = this.value;
            let returner = document.querySelector('.activator-item');
            let data = JSON.stringify({tracker:val,permition:'AdminIsPermited'});
            let xhr = new XMLHttpRequest();
                xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
                xhr.onreadystatechange = function(){
                    // let resp = JSON.parse(this.response);
                    if(this.status == 200 && this.readyState == 4){
                         returner.innerHTML = this.response;
                         __takeACtionToLoan();
                        return;
                    }
                }
                xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                xhr.send('JUSTICEuYOLOanTracker='+data);
        })
}



//accepted
function __sys_accept__(){
    let acceptAll = document.querySelectorAll('._UYO_eyenakwaibom');
        acceptAll.forEach((button, index) => {
            button.addEventListener('click', function(){
                let a, b, c,d, e, f, g, h, i, j, k, l, m, n, o, p;
                let inpt = document.querySelectorAll('.msgTxT');
                d = document.querySelector('.__mpkdk34kk210kd___'); //return error

                a = this.getAttribute('uid'); //mem uid
                b = this.getAttribute('phone'); //mem ph
                c = inpt[index].value; //input value
                h = inpt[index];
                j = this.getAttribute('tid');
                k = this.getAttribute('ibaad'); //ibaad akuk se anye ayem
                l = document.querySelectorAll('._UYO90awoimahamien')[index];

                this.disabled = true;
                i = document.querySelector('.adm-prev').getAttribute('mpc-admid');

                if(c == '')
                {
                    d.innerText = 'Please let this member understand that his/her Loan Application has been approved.';
                    d.classList.add('text-danger');
                    d.classList.add('alert-danger');
                    d.classList.remove('bg-dark');
                    this.disabled = false;
                    return;

                }else if(c.length < 30)
                {
                    d.innerText = 'Your message length is too short...';
                    d.classList.add('text-danger');
                    d.classList.remove('bg-dark');
                    d.classList.add('alert-danger');
                    this.disabled = false;

                    return;
                }

                let currBtn = this;
                let isApproval = 'ksxl490dlsd43_';
                f = JSON.stringify({uid:a, phone:b, appMsg: c, disburser:i, tid:j, ibaadAkuk: k});

                xhr = new XMLHttpRequest();
                xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
                xhr.onreadystatechange = function(){
                    if(this.status == 200 && this.readyState == 4)
                    {
    
    // alert(currBtn);
    g = JSON.parse(this.response); //response here
    if(g.code == '#400')
    {
        d.innerText = 'Unexpected error occur please try and verify before trying again "System responded with ' + g.msg + '"';
        d.classList.add('bg-danger');
        d.classList.add('alert-danger');
        d.classList.remove('bg-dark');
        currBtn.disabled = false;
        return;
    }

        d.innerText = 'You have successfully Approved Loan Request for this member';
        currBtn.disabled = true;
        // d.classList.add('bg-success');
        d.classList.add('alert-success');
        d.classList.add('text-success');
        d.classList.remove('bg-dark');
        h.disabled = true;
        h.title = '';
        l.disabled = true;
        // alert(l)
        // console.log(l)
        currBtn.innerHTML = '<i class="fas fa-check"></i> Approved';


// alert(this.response);

                    }
                }
                xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                xhr.send('_dkl4kdklsk04_Apr'+isApproval+'=' +f);
            })
        })
}

//rejected widthdrawal
function __sys_rejected__(){
    let acceptAll = document.querySelectorAll('._UYO90awoimahamien');
        acceptAll.forEach((button, index) => {
            button.addEventListener('click', function(){
                let a, b, c,d, e, f, g, h, i, j, k;
                let inpt = document.querySelectorAll('.msgTxT');
                d = document.querySelector('.__mpkdk34kk210kd___'); //return error
                let approvedButton = document.querySelectorAll('._UYO_eyenakwaibom');
                let approvedMsg = document.querySelectorAll('.msgTxT');//msgTxT
                a = this.getAttribute('uid'); //mem uid
                b = this.getAttribute('phone'); //mem ph
                c = inpt[index].value; //input value
                h = inpt[index];
                j = this.getAttribute('tid');
                k = this.getAttribute('ibaad'); //ibaad akuk se anye ayem

                this.disabled = true;
                approvedButton[index].disabled = true;
                approvedMsg[index].disabled = true;
                i = document.querySelector('.adm-prev').getAttribute('mpc-admid');

                if(c == '')
                {
                    d.innerText = 'Please let this member understand why his/her Loan Application was cancel or rejected.';
                    d.classList.add('text-danger');
                    d.classList.add('alert-danger');
                    d.classList.remove('bg-dark');
                    this.disabled = false;
                    return;

                }else if(c.length < 30)
                {
                    d.innerText = 'Your message length is too short...';
                    d.classList.add('text-danger');
                    d.classList.remove('bg-dark');
                    d.classList.add('alert-danger');
                    this.disabled = false;

                    return;
                }

                let currBtn = this;
                let isApproval = 'ksxl490dlsd43_';
                f = JSON.stringify({uid:a, phone:b, appMsg: c, disburser:i, tid:j, ibaadAkuk: k});

                xhr = new XMLHttpRequest();
                xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
                xhr.onreadystatechange = function(){
                    if(this.status == 200 && this.readyState == 4)
                    {
    
    // alert(currBtn);
    g = JSON.parse(this.response); //response here
    if(g.code == '#400')
    {
        d.innerText = 'Unexpected error occur please try and verify before trying again "System responded with ' + g.msg + '"';
        d.classList.add('bg-danger');
        d.classList.add('alert-danger');
        d.classList.remove('bg-dark');
        currBtn.disabled = false;
        return;
    }

        d.innerText = 'You have successfully Declined Loan Application for this member';
        currBtn.disabled = true;
        // d.classList.add('bg-success');
        d.classList.add('alert-success');
        d.classList.add('text-success');
        d.classList.remove('bg-dark');
        h.disabled = true;
        h.title = '';
        currBtn.innerHTML = '<i class="fas fa-xmark"></i> Rejected';


// alert(this.response);

                    }
                }
                xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                xhr.send('_mpcDclineAreques'+isApproval+'=' +f);
            })
        })
}


//function
//show admin previous withdrawal info 
function __ppending_(){
    let a, b,c ,d, e,f, g, h, body, xhr, i, j;
        a = document.querySelector('.skyBobmarleyosadebepetereffiomeddyemmanuel');
        a.onclick = function(){
            h = document.querySelector('.Usr-rtn');
            b = document.createElement('DIV');
            body = document.body;
            body.classList.add('pendingWRQ');
            b.className = 'anytimepopOva kdkll_ kdsks__';

            // i = h.getAttribute('mpcmemberphone');
            // j = h.getAttribute('mpcmemberid');

            d = document.createElement('SPAN');
            d.className = 'close-btn close-down text-danger';
            d.innerHTML = '<i class="fas fa-xmark fa-3x fa-shake"></i>';

            c = document.createElement('DIV');
            c.className = 'kkxk4yk42ee bg-light';

            e = document.createElement('h5');
            e.className = 'shadow sticky-top bg-light p-2 xkj4d';
            e.innerHTML = 'GOODLIFE (UYO) MPCS Approved And Declined Widthdrawal Request.';
            c.appendChild(e); //

            f = document.createElement('DIV');
            f.className = 'lslxkdkd p-2 kdmk4uddd';

            // let data = JSON.stringify({UID:j, PHONE:i});
            xhr = new XMLHttpRequest();
            xhr.open('GET', __mpc_uri__() + 'functions/mpc-ajax-action.php?pRQ=xmkdkd849JqQ&data=xmmkk4kkdcmdk4__dskkalk4dad', true);
            xhr.onreadystatechange = function(){
                if(this.readyState == 4 && this.status == 200){
                    f.innerHTML = this.response;
                }
            }
            xhr.send();

            c.appendChild(f);
            b.appendChild(d);
            b.appendChild(c);
            body.appendChild(b);
            _close_() //close btn
        }
}


//close pending withdrawal check
function _close_(){
    let btn = document.querySelector('.close-btn');
        btn.addEventListener('click', function(){
            document.querySelector('.kdsks__').remove();
            document.body.classList.remove('pendingWRQ');
        })
}


//function to calculate days work for
function returnOnlyYearsWorkedFor(start, end){

    // Define the start and end dates
    const startDate = start;
    const endDate = end;

    // Calculate the difference in milliseconds
    const differenceMs = endDate - startDate;

    // Convert milliseconds to years (assuming 365 days in a year)
    const differenceYears = differenceMs / (1000 * 60 * 60 * 24 * 365);
    const monthDiff = differenceMs / (1000 * 60 * 60 * 24 * 12);

    // Round down to get the whole number of years
    const yearsWorked = Math.floor(differenceYears);

    return yearsWorked;

}

function calculateTotalYearsOfWork(start, end){

    // Define the start and end dates
    const startDate = start;
    const endDate = end;

    // Calculate the difference in milliseconds
    const differenceMs = endDate - startDate;

    // Convert milliseconds to years
    let differenceYears = differenceMs / (1000 * 60 * 60 * 24 * 365);
    differenceYears = Math.floor(differenceYears);

    // Calculate the remaining milliseconds after subtracting the years
    let remainingMs = differenceMs - (differenceYears * 1000 * 60 * 60 * 24 * 365);

    // Convert remaining milliseconds to months
    const differenceMonths = Math.floor(remainingMs / (1000 * 60 * 60 * 24 * 30.4375));

    // Calculate the remaining milliseconds after subtracting the months
    remainingMs = remainingMs - (differenceMonths * 1000 * 60 * 60 * 24 * 30.4375);

    // Convert remaining milliseconds to days
    const differenceDays = Math.floor(remainingMs / (1000 * 60 * 60 * 24));

    // Calculate the remaining milliseconds after subtracting the days
    remainingMs = remainingMs - (differenceDays * 1000 * 60 * 60 * 24);

    // Convert remaining milliseconds to hours
    const differenceHours = Math.floor(remainingMs / (1000 * 60 * 60));

    const m = `You worked for : ${differenceYears} Years, ${differenceMonths} Months, ${differenceDays}  Days, ${differenceHours} Hours`;

    return m;
}

//allowed admin check members fund
function checkFunds(){
    let btn, a, b, c, d,e,f, g, h,i,j, uid, phone;
    btn = document.querySelectorAll('.fundsChk');
    btn.forEach((btns, index) =>{
        btns.addEventListener('click', function(){
            uid = this.getAttribute('uid');
            phone = this.getAttribute('ph');
            name = this.getAttribute('name');

            a = document.createElement('SECTION');
            a.className = 'mpc-popup-anytime';
                b = document.createElement('DIV');
                b.className = 'mpc-popup-bg';

                    c = document.createElement('DIV');
                    c.className = 'close-mpc-popup';
                    c.innerHTML = '<i class="fas fa-xmark fa-2x fa-shake"></i>';
                    c.title = 'Click here to close this pop-up window';
                b.appendChild(c);

                    d = document.createElement('SPAN');
                    d.className = 'Upload-status';
                    d.innerText = name;
                b.appendChild(d);

                    e = document.createElement('DIV');
                    e.className = 'mpc_blitz funds-moving';
                    e.innerHTML = `
                        <div class="container-sm border-sm">
                    <div class="sm-tr d-flexs">
                        <h6 class="shadow sticky-top p-1 text-muted">Select Which account to move funds</h6>
                        <hr class="mpcHr">
                        <section>
                            <div class="fromAcountWrap d-flex">
                                <select class="adm-select createLoanInput moveFunds fromAccount">
                                    <option value="">---From Account---</option>
                                    <option value="THRIFT">Thrift savings</option>
                                    <option value="SHARES">Shares Account</option>
                                </select>

                                <span class="text-muted">â‚¦ <span class="FromBalance alert-success p-1">0.00</span></span>
                            </div>
                        </section>
                        
                        <hr class="mpcHr">
                        <section>
                            <div class="fromAcountWrap d-flex">
                                <select class="adm-select createLoanInput moveFunds toAccount">
                                    <option value="">---To Account---</option>
                                    <option value="SPECIAL">Special Savings</option>

                                </select>

                                <span class="text-muted">â‚¦ <span class="ToBalance alert-success p-1">0.00</span></span>
                            </div>
                        </section>
                        <hr class="mpcHr">
                        <section class="p-2">
                            <button uid="${uid}" phone="${phone}" class="memberfundmover btn btn-secondary btn-block mpc-btn-fullWidth" disabled="disabled">Move funds</button>
                        </section>
                        
                    </div>
                </div>
                    `;
                b.append(e);

            a.appendChild(b);

        document.body.insertAdjacentElement('afterbegin', a);
            fromAccountCheckBalance(); //FROM ACCOUNT BALANCE CHECK
            ToAccountCheckBalance(); //to account a
            mpc_ReadPopclose();//close popup box

        })
    })
}

//from account balance check
function fromAccountCheckBalance(){
    let select = document.querySelector('.fromAccount');
        select.addEventListener('change', function(){
            let btn = document.querySelector('.memberfundmover');
            let uid = btn.getAttribute('uid');
            let phone = btn.getAttribute('phone');
            let data = JSON.stringify({uid:uid, phone:phone, type:this.value});
            let returnBalance = document.querySelector('.FromBalance');
            let rtnTxt = document.querySelector('.Upload-status');


            rtnTxt.innerHTML = 'You are about to Move funds from members ' + this.value + ' Account!';

        if(this.value !== ''){
            rtnTxt.innerHTML = 'Please wait... PROCESSING';
            let xhr = new XMLHttpRequest();
            xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
            xhr.onreadystatechange = function(){
                if(this.readyState == 4 && this.status == 200){
                    rtnTxt.innerHTML = 'Balance Retrieved successfully';

                    // returnBalance.innerHTML = JSON.parse(this.response).balance;
                    if(JSON.parse(this.response).msg == 'balance fetch'){

                         returnBalance.innerHTML = this.response;
                        returnBalance.innerHTML = JSON.parse(this.response).balance;
                        btn.disabled = false;
                        rtnTxt.classList.remove('alert-danger');
                        rtnTxt.classList.remove('fa-fade');
                        // alert(this.response);
                        return;
                    }
                    rtnTxt.innerHTML = 'Error, fail to load members balance on this Account, Try again Or contact developer!';
                    rtnTxt.classList.add('alert-danger');
                    rtnTxt.classList.add('fa-fade');
                    btn.disabled = true;
                }
            }
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.send('ReturnBalanceToMove='+ data);
        }
    })
}
/*
dash dash
dot dot 
dash dot
dot 
dot dash dot 
*/
//from account balance check
function ToAccountCheckBalance(){
    let select = document.querySelector('.toAccount');
        select.addEventListener('change', function(){
            let btn = document.querySelector('.memberfundmover');
            let uid = btn.getAttribute('uid');
            let phone = btn.getAttribute('phone');
            let data = JSON.stringify({uid:uid, phone:phone, type:this.value});
            let returnBalance = document.querySelector('.ToBalance');
            let rtnTxt = document.querySelector('.Upload-status');


            rtnTxt.innerHTML = 'You are Moving funds to ' + this.value + ' savings Account!';

        if(this.value !== ''){
            rtnTxt.innerHTML = 'Please wait... PROCESSING';
            let xhr = new XMLHttpRequest();
            xhr.open('POST', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
            xhr.onreadystatechange = function(){
                if(this.readyState == 4 && this.status == 200){
                    rtnTxt.innerHTML = 'Balance Retrieved successfully';

                    returnBalance.innerHTML = JSON.parse(this.response).balance;
                    if(JSON.parse(this.response).msg == 'balance fetch'){

                         returnBalance.innerHTML = this.response;
                        returnBalance.innerHTML = JSON.parse(this.response).balance;
                        btn.disabled = false;
                        rtnTxt.classList.remove('alert-danger');
                        rtnTxt.classList.remove('fa-fade');
                        movefundsOut(); //allowed account move funds
                        return;
                    }
                    rtnTxt.innerHTML = 'Error, fail to load members balance on this Account, Try again Or contact developer!';
                    rtnTxt.classList.add('alert-danger');
                    rtnTxt.classList.add('fa-fade');

                    btn.disabled = true;
                 //   alert(this.response);

                    
                }
            }
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.send('ShowCurrentBalance='+ data);
        }
    })
}

//move members funds out
function movefundsOut(){
    let btnMoveer = document.querySelector('.memberfundmover');
        btnMoveer.onclick = function(){
            let fromAccount = document.querySelector('.fromAccount');
            let toAccount = document.querySelector('.toAccount');
            let balance = document.querySelector('.FromBalance');
            let rxt = document.querySelector('.Upload-status');
            let uid = this.getAttribute('uid');
            let phone = this.getAttribute('phone');
// alert(balance.innerText)
            if(Number(balance.innerText) <= 0){
                rxt.innerHTML = 'Unexpected error, Balance is too low';
                rxt.classList.add('alert-danger');
                rxt.classList.add('fa-fade');
                return;
            }
            let data = JSON.stringify({uid:uid, phone:phone, acct:fromAccount.value});
            if(confirm(`You are about to move Funds from member ${fromAccount.value} account  to ${toAccount.value} savings Account, Are you sure about this ?` ) === true){
                xhr = new XMLHttpRequest();
                xhr.open('post', __mpc_uri__() + 'functions/mpc-ajax-action.php', true);
                xhr.onreadystatechange = function(){
                    if(this.readyState == 4 && this.status == 200){
                        // if(JSON.parse(this.response).status == 4500){
                        //     rxt.innerHTML = 'Success: You have successfully move member\'s funds to a new Account';
                        //     return;
                        // }

                        // rxt.innerHTML = 'Unexpected Error: ' + JSON.parse(this.response).msg;
                        alert(this.response)
                    }
                }
                xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                xhr.send('xxmklskd=' + data);
            }
        }
}

// MPC CHOKE USER
loopErrorFix =() =>{
    btn = document.querySelectorAll('.__AS__');

    btn.forEach((el, i) =>{
        el.addEventListener('click', function(){
            let errs = document.querySelector('.mpc-admin-ds-notify');
            this.disabled = true;
            this.style.cursor = 'no-drop';
            let currBtn = this;

                currBtn.innerHTML = '<i class="fas fa-spin fa-spinner"></i>';
            let sendD = {uid: this.getAttribute('action-id'), phone: this.getAttribute('action-phone'), actionPermit: '__no_allowed__'};
            fetch(__mpc_uri__() + 'functions/bugs.php', {
                method:'POST',
                body: JSON.stringify(sendD),
                headers: {'Content-type' : 'application/json'}
            })
            .then(response => {
                if(!response.ok){
                    throw new Error(response.statusText);
                }else{
                    return response.text();
                }
            })
            .then(result => {
                let resp = JSON.parse(result);
                console.log(resp);
                if(!resp.status){
                    currBtn.classList.remove('btn-primary');
                    currBtn.classList.add('btn-danger');
                    currBtn.innerHTML = 'Action failed';
                    return;
                }

                currBtn.classList.remove('btn-primary');
                currBtn.classList.add('btn-success');
                currBtn.innerHTML = '<i class="fas fa-check-circle"></i> Fixed';
            })
            .catch(err => {
                errs.innerHTML = err;
                console.log(err)
            })
        })
    })
}